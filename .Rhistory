twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square2')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx3'
dist_intercrop=20
dist_intra=10
dist_inter=10
designType='quincunx3'
I_dist_intra=2
I_dist_inter=3
I_designType='square'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
# I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square2')
#
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='square'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='square2'
I_dist_intra=2
I_dist_inter=3
I_designType='square'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
I_designType='square2'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx3'
I_dist_intra=2
I_dist_inter=3
I_designType='square2'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx5'
I_dist_intra=2
I_dist_inter=3
I_designType='square2'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
dist_intercrop=20
dist_intra=10
dist_inter=10
designType='quincunx5'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square2')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square2')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
dist_intercrop=20
dist_intra=10
dist_inter=10
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
### get distance between intercrop edge and palms row
dist_edge=ifelse(designType %in% c('square','quincunx'),yes =dist_inter/2, no = (dist_intercrop-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2)
dist_edge
dist_inter
designType
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
design_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
### get distance between intercrop edge and palms row
dist_edge=(dist_intercrop-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2
if(designType %in% c('square','quincunx')){
dist_intercrop=0
if(I_designType %in% c('square','quincunx')){
dist_edge=dist_inter/2
}
}
print(dist_edge)
if((dist_edge)<0){
print('!!! intercroping area is larger than intercropping space between palm rows')
return(NULL)
}
### first generate palm design
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# a$plot
#### then generate intercrops design
### get distance between 2 consecutive intercropping areas (D_intercrops)
D_intercrops=2*dist_edge+sizeDesign[sizeDesign==designType,]$interLines*dist_inter
# if(designType %in% c('square','quincunx')){
#   # D_intercrops=2*dist_edge
#   if(I_designType %in% c('square','quincunx')){
#     D_intercrops=dist_inter
#   }
# }
if(I_designType %in% c('square','quincunx')){
I_dist_inter=D_intercrops
D_intercrops=0
print(paste('I_dist_inter is fixed to: ',I_dist_inter,'m'))
}
# print(paste('dist_edge=',dist_edge))
# print(paste('D_intercrops=',D_intercrops))
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=D_intercrops,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
### keep full intercropping area (remove first rows)
I_removeL=min(2,sizeDesign[sizeDesign$designType==I_designType,]$nLines-1) ### lines to remove
I_start=ifelse(I_removeL>0,unique(b$design$x)[I_removeL],0)
offSetL=max(1,min(2,sizeDesign[sizeDesign$designType==designType,]$nLines-1)) ### first lines  in palm design to get the offset of intercropping area
interCrop=  b$design %>%
filter(x>I_start) %>%
mutate(x=x-min(x)+unique(a$design$x)[offSetL]+dist_edge,y=y-min(y)) ### add the offset (dist_edge)
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point(aes(col= 'palms'),shape=8,size=pointSize)+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))+
scale_color_manual(name='',values = c('palms'='forestgreen','intercrop'='black'))
result=list(designPalm=a$design,designI=interCrop,plot=visu)
return(result)
}
dist_intercrop=20
dist_intra=10
dist_inter=10
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType
### get distance between intercrop edge and palms row
dist_edge=(dist_intercrop-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2
dist_edge
dist_intercrop
sizeDesign[sizeDesign==I_designType,]$interLines
I_dist_inter
designType
I_designType
dist_edge
dist_intercrop
dist_edge=(dist_inter-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2
dist_edge
dist_edge=dist_inter/2
dist_edge
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
design_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
### get distance between intercrop edge and palms row
dist_edge=(dist_intercrop-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2
if(designType %in% c('square','quincunx')){
dist_intercrop=0
dist_edge=(dist_inter-sizeDesign[sizeDesign==I_designType,]$interLines*I_dist_inter)/2
if(I_designType %in% c('square','quincunx')){
dist_edge=dist_inter/2
}
}
print(dist_edge)
if((dist_edge)<0){
print('!!! intercroping area is larger than intercropping space between palm rows')
return(NULL)
}
### first generate palm design
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# a$plot
#### then generate intercrops design
### get distance between 2 consecutive intercropping areas (D_intercrops)
D_intercrops=2*dist_edge+sizeDesign[sizeDesign==designType,]$interLines*dist_inter
# if(designType %in% c('square','quincunx')){
#   # D_intercrops=2*dist_edge
#   if(I_designType %in% c('square','quincunx')){
#     D_intercrops=dist_inter
#   }
# }
if(I_designType %in% c('square','quincunx')){
I_dist_inter=D_intercrops
D_intercrops=0
print(paste('I_dist_inter is fixed to: ',I_dist_inter,'m'))
}
# print(paste('dist_edge=',dist_edge))
# print(paste('D_intercrops=',D_intercrops))
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=D_intercrops,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
### keep full intercropping area (remove first rows)
I_removeL=min(2,sizeDesign[sizeDesign$designType==I_designType,]$nLines-1) ### lines to remove
I_start=ifelse(I_removeL>0,unique(b$design$x)[I_removeL],0)
offSetL=max(1,min(2,sizeDesign[sizeDesign$designType==designType,]$nLines-1)) ### first lines  in palm design to get the offset of intercropping area
interCrop=  b$design %>%
filter(x>I_start) %>%
mutate(x=x-min(x)+unique(a$design$x)[offSetL]+dist_edge,y=y-min(y)) ### add the offset (dist_edge)
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point(aes(col= 'palms'),shape=8,size=pointSize)+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))+
scale_color_manual(name='',values = c('palms'='forestgreen','intercrop'='black'))
result=list(designPalm=a$design,designI=interCrop,plot=visu)
return(result)
}
dist_intercrop=20
dist_intra=10
dist_inter=10
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
I_designType='square'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx2'
I_dist_intra=2
I_dist_inter=3
I_designType='square'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
I_designType='square2'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
#
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square2')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
# geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
#
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'square')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1)+
xlim(c(0,lim))+
ylim(c(0,lim))
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=2)+
xlim(c(0,lim))+
ylim(c(0,lim))
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1,alpha=0.8)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=2)+
xlim(c(0,lim))+
ylim(c(0,lim))
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1,alpha=0.8)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=17,alpha=0.8)+
xlim(c(0,lim))+
ylim(c(0,lim))
#
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'quincunx3')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1,alpha=0.8)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=17,alpha=0.8)+
xlim(c(0,lim))+
ylim(c(0,lim))
#
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'quincunx4')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1,alpha=0.8)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=17,alpha=0.8)+
xlim(c(0,lim))+
ylim(c(0,lim))
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
#
I2=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = 2,I_dist_inter =4,I_designType = 'quincunx4')
ggplot()+
geom_point(data=I1$designPalm,aes(x=x,y=y,col= 'palms'),shape=8,size=pointSize)+
geom_point(data=I1$designI,aes(x=x,y=y,col='intercrop1'),size=pointSize-1,alpha=0.8)+
geom_point(data=I2$designI,aes(x=x,y=y,col='intercrop2'),size=pointSize-1,pch=17,alpha=0.8)+
xlim(c(0,lim))+
ylim(c(0,lim))
# l=9.21
# h=sqrt(3*l**2/4)
# dist_intra=l
# dist_intercrop=2*h
# dist_inter=h
# designType='square'
# pointSize=3
warng=NULL
design=plot_design(dist_intra=d_intra,dist_inter=d_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,pointSize=pointSize,lim=lim,twist=0)
str(I1)
I1=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
str(I1)
test=design_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
str(test)
is.list(test)
runApp('App_design.R')
runApp('App_design.R')
runApp('App_design.R')
runApp('App_design.R')
runApp('App_design.R')
dist_intercrop=0
dist_intra=5
dist_inter=10
designType='quincunx'
plot_design(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim)
runApp('App_design.R')
runApp('App_design.R')
