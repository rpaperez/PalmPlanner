visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I_designType='square'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='square2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType
designType
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
(nrow(a$voronoi_plot)-1)
# Load packages -----------------------------------------------------------
packs <- c("lubridate", "stringr", 'tidyverse','viridis','data.table','yaml','png','cowplot','magick')
nrow(a$voronoi_plot)
a$voronoi_plot
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
plot_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
# I_dist_intra=2
# I_dist_inter=3
# I_designType='quincunx3'
# d_intercrop=12
# d_intra=10
# lim=100
# d_inter=7
# designType='quincunx5'
if(designType %in% c('square','quincunx')){
dist_intercrop=0}
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
print(nrow(a$voronoi_plot))
### get the middle and distance between intercrop area
if(designType %in% c('square','quincunx')){
middle=min(a$voronoi_plot$x)+dist_inter/2
D_intercrop=dist_inter
}
if(designType %in% c('square2','quincunx2')){
middle=min(a$voronoi_plot$x)+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(designType %in% c('quincunx3','quincunx4','quincunx5')){
middle=min(a$voronoi_plot$x)+dist_inter+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(I_designType %in% c('square','quincunx')){
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=dist_intercrop2,dist_intercrop=0,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
mutate(x=x-min(x)+middle,y=y-min(y))
}
if(I_designType %in% c('square2','quincunx2','quincunx3','quincunx4','quincunx5')){
dist_intercrop2=D_intercrop-(nrow(a$voronoi_plot)-1)*I_dist_inter
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=dist_intercrop2,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
filter(x>b$design$x[nrow(b$voronoi_plot)-1]) %>%
mutate(x=x-min(x)+middle-(nrow(b$voronoi_plot)-1)*I_dist_inter/2,y=y-min(y))
}
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='square'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx3'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx4'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='square2'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx2'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
plot_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
# I_dist_intra=2
# I_dist_inter=3
# I_designType='quincunx3'
# d_intercrop=12
# d_intra=10
# lim=100
# d_inter=7
# designType='quincunx5'
if(designType %in% c('square','quincunx')){
dist_intercrop=0}
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# print(nrow(a$voronoi_plot))
### get the middle and distance between intercrop area
if(designType %in% c('square','quincunx')){
middle=min(a$voronoi_plot$x)+dist_inter/2
D_intercrop=dist_inter
}
if(designType %in% c('square2','quincunx2')){
middle=min(a$voronoi_plot$x)+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(designType %in% c('quincunx3','quincunx4','quincunx5')){
middle=min(a$voronoi_plot$x)+dist_inter+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(I_designType %in% c('square','quincunx')){
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=dist_intercrop2,dist_intercrop=0,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
mutate(x=x-min(x)+middle,y=y-min(y))
}
if(I_designType %in% c('square2','quincunx2','quincunx3','quincunx4','quincunx5')){
dist_intercrop2=D_intercrop-(nrow(a$voronoi_plot)-1)*I_dist_inter
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=dist_intercrop2,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
filter(x>b$design$x[nrow(b$voronoi_plot)-1]) %>%
mutate(x=x-min(x)+middle-(nrow(b$voronoi_plot)-1)*I_dist_inter/2,y=y-min(y))
}
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx2'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx2'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I_designType='quincunx5'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
designType='quincunx5'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx5'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
I_designType='quincunx3'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
lim=100
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
plot_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
# I_dist_intra=2
# I_dist_inter=3
# I_designType='quincunx3'
# d_intercrop=12
# d_intra=10
# lim=100
# d_inter=7
# designType='quincunx5'
if(designType %in% c('square','quincunx')){
dist_intercrop=0}
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# print(nrow(a$voronoi_plot))
### get the middle and distance between intercrop area
if(designType %in% c('square','quincunx')){
middle=min(a$voronoi_plot$x)+dist_inter/2
D_intercrop=dist_inter
}
if(designType %in% c('square2','quincunx2')){
middle=min(a$voronoi_plot$x)+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(designType %in% c('quincunx3','quincunx4','quincunx5')){
middle=min(a$voronoi_plot$x)+dist_inter+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(I_designType %in% c('square','quincunx')){
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=dist_intercrop2,dist_intercrop=0,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
mutate(x=x-min(x)+middle,y=y-min(y))
}
if(I_designType %in% c('square2','quincunx2','quincunx3','quincunx4','quincunx5')){
# dist_intercrop2=D_intercrop-(nrow(a$voronoi_plot)-1)*I_dist_inter
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=dist_intercrop2,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
filter(x>b$design$x[nrow(b$voronoi_plot)-1]) %>%
mutate(x=x-min(x)+middle-(nrow(b$voronoi_plot)-1)*I_dist_inter/2,y=y-min(y))
}
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx5'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
plot_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
# I_dist_intra=2
# I_dist_inter=3
# I_designType='quincunx3'
# d_intercrop=12
# d_intra=10
# lim=100
# d_inter=7
# designType='quincunx5'
if(designType %in% c('square','quincunx')){
dist_intercrop=0}
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# print(nrow(a$voronoi_plot))
### get the middle and distance between intercrop area
if(designType %in% c('square','quincunx')){
middle=min(a$voronoi_plot$x)+dist_inter/2
D_intercrop=dist_inter
}
if(designType %in% c('square2','quincunx2')){
middle=min(a$voronoi_plot$x)+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(designType %in% c('quincunx3','quincunx4','quincunx5')){
middle=min(a$voronoi_plot$x)+dist_inter+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(I_designType %in% c('square','quincunx')){
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=dist_intercrop2,dist_intercrop=0,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
mutate(x=x-min(x)+middle,y=y-min(y))
}
if(I_designType %in% c('square2','quincunx2','quincunx3','quincunx4','quincunx5')){
# dist_intercrop2=D_intercrop-(nrow(a$voronoi_plot)-1)*I_dist_inter
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=dist_intercrop2,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
filter(x>b$design$x[nrow(b$voronoi_plot)-1]) %>%
mutate(x=x-min(x)+middle-(nrow(b$voronoi_plot)-1)*I_dist_inter/2,y=y-min(y))
}
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx5'
designType='quincunx1'
I_dist_intra=2
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx3'
lim=100
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
#' @param lim limit of the area for plotting map (m)
#' @param twist twist/rotation of the palm stem in the ops file (in degree)
#' @param I_dist_intra distance within row of intercrop (m)
#' @param I_dist_inter distance between rows of intercrop (m)
#' @param I_designType type of design for intercrop (square,square2,quincunx,quincunx2,quincunx3,quincunx4,quincunx5)
#'
#' @return
#' @export
#'
#' @examples
plot_intercrop=function(dist_intra=NULL,dist_inter=NULL,dist_intercrop=NULL,designType=NULL,orientation=orientation,twist=twist,pointSize=5,lim=50,I_dist_intra=NULL,I_dist_inter=NULL,I_designType=NULL){
# I_dist_intra=2
# I_dist_inter=3
# I_designType='quincunx3'
# d_intercrop=12
# d_intra=10
# lim=100
# d_inter=7
# designType='quincunx5'
if(designType %in% c('square','quincunx')){
dist_intercrop=0}
a=plot_design(dist_intra=dist_intra,dist_inter=dist_inter,dist_intercrop=dist_intercrop,designType=designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=lim)
# print(nrow(a$voronoi_plot))
### get the middle and distance between intercrop area
if(designType %in% c('square','quincunx')){
middle=min(a$voronoi_plot$x)+dist_inter/2
D_intercrop=dist_inter
}
if(designType %in% c('square2','quincunx2')){
middle=min(a$voronoi_plot$x)+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(designType %in% c('quincunx3','quincunx4','quincunx5')){
middle=min(a$voronoi_plot$x)+dist_inter+dist_intercrop/2
D_intercrop=dist_intercrop+(nrow(a$voronoi_plot)-1)*dist_inter
}
if(I_designType %in% c('square','quincunx')){
dist_intercrop2=D_intercrop
b=plot_design(dist_intra=I_dist_intra,dist_inter=dist_intercrop2,dist_intercrop=0,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
mutate(x=x-min(x)+middle,y=y-min(y))
}
if(I_designType %in% c('square2','quincunx2','quincunx3','quincunx4','quincunx5')){
dist_intercrop2=D_intercrop-(nrow(a$voronoi_plot)-1)*I_dist_inter
b=plot_design(dist_intra=I_dist_intra,dist_inter=I_dist_inter,dist_intercrop=dist_intercrop2,designType=I_designType,orientation=orientation,twist=twist,pointSize=pointSize,lim=2*lim)
interCrop=b$design %>%
filter(x>b$design$x[nrow(b$voronoi_plot)-1]) %>%
mutate(x=x-min(x)+middle-(nrow(b$voronoi_plot)-1)*I_dist_inter/2,y=y-min(y))
}
visu=a$design %>%
ggplot(aes(x=x,y=y))+
geom_point()+
geom_point(data=interCrop,aes(x=x,y=y,col='intercrop'))+
xlim(c(0,lim))+
ylim(c(0,lim))
return(visu)
}
dist_intercrop=12
dist_intra=10
dist_intercrop=12
dist_intra=10
dist_inter=7
designType='quincunx5'
I_dist_intra=2
I_dist_inter=3
I_designType='quincunx'
lim=50
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
lim=100
orientation='NS'
twist=0
pointSize=3
plot_intercrop(dist_intra =dist_intra,dist_inter =dist_inter,designType =designType,dist_intercrop =dist_intercrop,orientation = orientation,twist = twist,pointSize =pointSize,lim = lim, I_dist_intra = I_dist_intra,I_dist_inter =I_dist_inter,I_designType = I_designType)
